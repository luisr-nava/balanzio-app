model CashRegister {
  id                String           @id @default(uuid())
  shopId            String
  employeeId        String

  // Apertura
  openingAmount     Float            // Monto inicial al abrir
  openedAt          DateTime         @default(now())
  openedBy          String           // User ID

  // Cierre
  closingAmount     Float?           // Monto al cerrar (esperado según ventas)
  actualAmount      Float?           // Monto real contado
  difference        Float?           // Diferencia (falta/sobrante)
  closedAt          DateTime?
  closedBy          String?          // User ID
  closingNotes      String?

  // Estado
  status            CashRegisterStatus @default(OPEN)

  // Relaciones
  shop              Shop             @relation(fields: [shopId], references: [id])
  movements         CashMovement[]

  @@index([shopId, status])
  @@index([openedAt])
}

model CashMovement {
  id              String         @id @default(uuid())
  cashRegisterId  String
  shopId          String

  // Tipo y monto
  type            CashMovementType
  amount          Float
  description     String?

  // Referencia
  saleId          String?        @unique
  incomeId        String?        @unique
  expenseId       String?        @unique
  userId          String

  // Fecha
  createdAt       DateTime       @default(now())

  // Relaciones
  cashRegister    CashRegister   @relation(fields: [cashRegisterId], references: [id])
  sale            Sale?          @relation(fields: [saleId], references: [id])
  income          Income?        @relation(fields: [incomeId], references: [id])
  expense         Expense?       @relation(fields: [expenseId], references: [id])

  @@index([cashRegisterId, createdAt])
  @@index([shopId, createdAt])
}

enum CashRegisterStatus {
  OPEN      // Caja abierta
  CLOSED    // Caja cerrada
  CANCELLED // Caja cancelada
}

enum CashMovementType {
  SALE          // Venta en efectivo
  INCOME        // Ingreso extra
  EXPENSE       // Egreso
  OPENING       // Apertura de caja
  WITHDRAWAL    // Retiro de efectivo
  DEPOSIT       // Depósito adicional
  ADJUSTMENT    // Ajuste manual
}
